{% extends 'base.html' %}

{% block content %}
  <div style="display:flex;gap:16px">
    <div style="flex:1">
      <div class="card">
        <h3>Your Profile</h3>
        {% if student %}
          <form method="post" action="{{ url_for('student_edit') }}">
            <label>Name</label><br />
            <input name="name" value="{{ student['name'] or '' }}" style="width:100%" />
            <label>Address</label><br />
            <input name="address" value="{{ student['address'] or '' }}" style="width:100%" />
            <label>Phone (10 digits)</label><br />
            <input name="phone" value="{{ student['phone'] or '' }}" pattern="\d{10}" style="width:100%" />
            <div style="margin-top:8px"><button type="submit">Save</button></div>
          </form>

          <hr />
          <h4>Academic</h4>
          <p>GPA: {{ student['gpa'] }}</p>
          <p>Total credits: {{ student['total_credits'] }}</p>
          <p>Balance: ${{ '%.2f'|format(student['balance'] or 0.0) }}</p>
          <p class="muted">Last updated: {{ student['updated_at'] }}</p>
        {% else %}
          <p class="muted">No student record found.</p>
        {% endif %}
      </div>
    </div>

    <div style="width:360px">
      <div class="card">
        <h3>Recent activity</h3>
        {% if transactions %}
          <ul>
          {% for t in transactions %}
            <li class="muted">[{{ t['timestamp'] }}] <strong>{{ t['actor_username'] }}</strong> — {{ t['action'] }} — {{ t['details'] }}</li>
          {% endfor %}
          </ul>
        {% else %}
          <p class="muted">No recent activity.</p>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}